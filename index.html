<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kii's Secretary</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@0.344.0/dist/umd/lucide.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- あなたの設定をすべて反映済み ---
        const firebaseConfig = {
            apiKey: "AIzaSyBXDp6iEudhalJGQE-cxOZw4-scYvlnAjE",
            authDomain: "tasuku-app-2d0cd.firebaseapp.com",
            projectId: "tasuku-app-2d0cd",
            storageBucket: "tasuku-app-2d0cd.firebasestorage.app",
            messagingSenderId: "576034343714",
            appId: "1:576034343714:web:d4556461f0a3c52453337b",
            measurementId: "G-38W947XG7V"
        };
        
        const GEMINI_API_KEY = "AIzaSyBuCdxrtXozaTUJOItw3J-A9VCRLTFzr5s";
        const appId = 'tasuku-App-v1';
        // ------------------------------

        // Firebase初期化
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // アイコン表示用コンポーネント
        const LucideIcon = ({ name, className = "w-5 h-5" }) => {
            useEffect(() => { 
                if (typeof lucide !== 'undefined') lucide.createIcons(); 
            }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        const App = () => {
            const [user, setUser] = useState(null);
            const [tasks, setTasks] = useState([]);
            const [userInput, setUserInput] = useState("");
            const [advice, setAdvice] = useState("Kiiさん、あなたのタスクを待っています...");

            useEffect(() => {
                // 匿名認証でログイン
                auth.signInAnonymously().catch(console.error);
                auth.onAuthStateChanged(u => setUser(u));
            }, []);

            return (
                <div className="min-h-screen p-6 md:p-12 max-w-3xl mx-auto font-sans">
                    <header className="flex justify-between items-center mb-10">
                        <div className="flex items-center gap-2 text-indigo-600">
                            <LucideIcon name="cloud" className="w-8 h-8" />
                            <h1 className="text-3xl font-black italic text-slate-900 tracking-tighter">
                                Kii's <span className="text-indigo-600">Secretary</span>
                            </h1>
                        </div>
                        <div className="bg-white p-3 rounded-2xl border border-slate-200 shadow-sm text-slate-400">
                            <LucideIcon name="settings" />
                        </div>
                    </header>

                    <div className="bg-indigo-600 rounded-[40px] p-8 text-white shadow-xl mb-10 relative overflow-hidden transition-all hover:scale-[1.01]">
                        <div className="relative z-10">
                            <div className="flex items-center gap-2 text-[10px] font-bold uppercase tracking-[0.3em] opacity-70 mb-4">
                                <LucideIcon name="lightbulb" className="w-4 h-4" /> Secretary Advice
                            </div>
                            <p className="text-xl font-bold leading-relaxed">{advice}</p>
                        </div>
                    </div>

                    <div className="bg-white rounded-[40px] p-10 border border-slate-100 shadow-sm mb-12 focus-within:ring-2 focus-within:ring-indigo-400 transition-all">
                        <textarea 
                            value={userInput}
                            onChange={(e) => setUserInput(e.target.value)}
                            className="w-full h-32 border-none focus:ring-0 text-2xl font-medium resize-none placeholder:text-slate-200"
                            placeholder="今日やることを教えてください..."
                        />
                        <div className="flex justify-end mt-6">
                            <button className="bg-slate-900 text-white px-10 py-4 rounded-full font-black text-sm flex items-center gap-3 hover:bg-indigo-600 active:scale-95 transition-all shadow-lg">
                                <LucideIcon name="send" className="w-4 h-4 text-indigo-400" /> 反映する
                            </button>
                        </div>
                    </div>

                    <div className="flex items-center justify-center gap-4 text-slate-300">
                        <div className="h-px bg-slate-200 flex-1"></div>
                        <LucideIcon name="zap" className="w-4 h-4 fill-slate-200" />
                        <div className="h-px bg-slate-200 flex-1"></div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
